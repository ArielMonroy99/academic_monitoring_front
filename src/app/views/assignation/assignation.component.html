<main class="flex flex-col h-[87vh] border rounded-md  bg-bg-color">
    <div class="w-full flex justify-start p-4">
        <h1 class="text-lg font-semibold text-start">Asignación de horarios</h1>
    </div>
    <div class="grid grid-cols-5A  justify-evenly  p-4">
        <div></div>
        <div class="flex flex-col border rounded-md bg-white h-fit w-full pb-2 justify-center items-center">
            <h2 class="text-md font-semibold my-4">Grado</h2>
            <ul>
                @for(grade of gradeList; track grade.id){
                <li class="flex justify-center my-2 ">
                    <button class="border rounded-md p-2 w-32  transition-colors hover:bg-active  hover:text-white"
                        (click)="selectGrade(grade)"
                        [ngClass]="{'bg-active':grade.id === selectedGrade.id,'text-white':grade.id === selectedGrade.id, 'bg-slate-200': grade.id!== selectedGrade.id}">{{grade.number}}°
                        {{grade.section}}</button>
                </li>
                }
            </ul>
        </div>
        @if(selectedGrade){
        <div>
            <ul>
                @for(class of classList; track class.id){
                <li class="flex justify-center">
                    <button (click)="selectClass(class)" class="border rounded-md p-2 w-32 "
                        [ngClass]="{'bg-active':class.id === selectedClass.id, 'text-white': class.id === selectedClass.id}">
                        {{class.identifier}}</button>
                </li>
                }
            </ul>
        </div>
        }
        @if(selectedClass){
        <div>
            <ul>
                @for(subject of subjectList; track subject.id){
                <li class="flex justify-center">
                    <button (click)="selectSubject(subject)" class="border rounded-md p-2 w-32"
                        [ngClass]="{'bg-selected':subject.id === selectedSubject.id,'text-white': subject.id === selectedSubject.id}">{{subject.name}}</button>
                </li>
                }
            </ul>
        </div>
        <div class="flex flex-col w-full">
            @if(selectedSubject.id ){
            <div class="flex w-full justify-between">
                <select (change)="selectTeacher($event)" class="w-2/5">
                    <option value="0">Seleccionar docente</option>
                    @for(teacher of teacherList; track teacher.id){
                    <option value="{{teacher.id}}">{{teacher.person.name}}</option>
                    }
                </select>
                <button (click)="getSchedules()" class="border rounded-md bg-selected text-white p-2">Calcular</button>
            </div>
            }
            @if(selectedSubject){
            <div>
                <ul class="flex flex-row m-2">
                    @for(classroom of classroomList; track classroom.id){
                    <li class="mx-2">
                        <button (click)="selectClassroom(classroom)" class="border rounded-md p-2 w-32"
                            [ngClass]="{'bg-selected':classroom.id === selectedClassroom.id,'text-white': classroom.id === selectedClassroom.id}">{{classroom.type}}
                            {{classroom.block}}
                            {{classroom.number}}</button>
                    </li>
                    }
                </ul>
            </div>
            }
            @if(showSchedule){
            <div class="flex w-full">
                <table class="table-fixed table w-full">
                    <tr class="border bg-primary text-white w-3/4">
                        <th class="text-center">Horario</th>
                        <th class="text-center">Lunes</th>
                        <th class="text-center">Martes</th>
                        <th class="text-center">Miércoles</th>
                        <th class="text-center">Jueves</th>
                        <th class="text-center">Viernes</th>
                    </tr>
                    @for(day of showedSchedule; track day; let idx = $index){
                    <tr>
                        <td class="border text-center h-10">{{hours[idx].start }} - {{hours[idx].end }}</td>
                        @for(period of day; track period.period; let dayIdx = $index){
                        <td class="border cursor-pointer text-center text-white hover:opacity-95" [ngClass]="{'bg-red-500':period.isAvailable=== false && period.reason !== 'selected',
                                'bg-green-500':period.isAvailable,
                                'bg-blue-500':period.isAvailable === false && period.reason === 'selected'
                                 }" (click)="selectSchedule(period,dayIdx)">
                            @if(!period.isAvailable && period.reason === 'selected'){
                            <span>Seleccionado</span>
                            }
                            @if(!period.isAvailable && period.reason !== 'selected'){
                            <span>no disponible</span>
                            }
                            @if(period.isAvailable){
                            <span>Disponible</span>
                            }
                        </td>
                        }
                    </tr>
                    }
                </table>
            </div>
            <div class="flex w-1/3">

            </div>
            }
        </div>
        }

        <div class="w-1/3">
            <button (click)="onSubmit()" class="bg-primary text-white border rounded-md p-2">Asignar</button>
        </div>
    </div>
</main>